nohup: ignoring input
########## DataInfo ##########
cpu num: 4
reading ./datasets/yelp/seq//item_succeeding2.dat
./datasets/yelp/seq//item_succeeding2.dat loaded
reading seq.dat
numUser:22844
numItem:16553
########## config ##########
thread_num: 4
dataset: yelp
eval_neg_num: full
input_len: 5
threshold: 1
rec_model: SASRec
train_type: train
co-train: False
filter-with-loss: False
save_epochs: [300, 400]
epoch_num: 500
learning_rate: 0.01
train_batch_size: 1024
test_batch_size: 512
drop_ratio: 0.1
n_layers: 2
next_hop_num: 1
entropy_threshold: 1.0
sample_num: 4
sample_loss_weight: 0.001
decay_factor: 0.9
hidden_size: 64
num_hidden_layers: 1
num_attention_heads: 2
intermediate_size: 128
hidden_act: gelu
hidden_dropout_prob: 0.1
attention_probs_dropout_prob: 0.1
type_vocab_size: 1
initializer_range: 0.1
weight_decay: 0.01
device: cuda
max_seq_len: 5
corr_epoch: 3
corr_threshold: 1
delete_target_ratio: 0.2
delete_input_ratio: 0.1
replace_ratio: 0.5
rectify_input: True
rectify_target: True
replace_target: True
self_ensemble: True
temperature: 0.01
weighted_loss: False
rho: 0.9
n_h: 16
n_v: 4
gru_layer_num: 2
candidate_size: 2
user_num: 22844
item_num: 16553
generating train samples
train_size: 191311, time: 1.9637961387634277
abandoned 0(0.0) samples
valid user num: 22844
valid item num: 16549
begin to initialize the replacement candidate pool
replacement candidate pool initialized successfully!, time: 4.158094644546509
generating test samples
test_size: 22844, time: 27.852615118026733
abandoned 0(0.0) samples
============================================================
Start Training
============================================================
################## epoch 0 ###########################
loss: 1897.0888, len_train_loader:187, train time: 14.03746247291565
rectified_input_ratio: 0.0
rectified_target_ratio: 0.0
########## current_metrics ##########
ndcg_1: 0.0014008054631413063
ndcg_5: 0.002870389260351658
ndcg_10: 0.003633025800809264
ndcg_20: 0.004688288550823927
hit_1: 0.0014008054631413063
hit_5: 0.004333741901593417
hit_10: 0.0066976011206443704
hit_20: 0.010943792680791455
ap: 0.004286465235054493
########## best_metrics ##########
ndcg_1: 0.0014008054631413063
ndcg_5: 0.002870389260351658
ndcg_10: 0.003633025800809264
ndcg_20: 0.004688288550823927
hit_1: 0.0014008054631413063
hit_5: 0.004333741901593417
hit_10: 0.0066976011206443704
hit_20: 0.010943792680791455
ap: 0.004286465235054493
no increase in recent 0 iters
eval time: 63.85979700088501
#########################################################
################## epoch 1 ###########################
loss: 867.8668, len_train_loader:187, train time: 6.512085676193237
rectified_input_ratio: 0.0
rectified_target_ratio: 0.0
########## current_metrics ##########
ndcg_1: 0.001444580633864472
ndcg_5: 0.0030366461724042892
ndcg_10: 0.00412707170471549
ndcg_20: 0.0056129805743694305
hit_1: 0.001444580633864472
hit_5: 0.004596392925932411
hit_10: 0.008010856242339345
hit_20: 0.013920504289966731
ap: 0.004906777758151293
########## best_metrics ##########
ndcg_1: 0.001444580633864472
ndcg_5: 0.0030366461724042892
ndcg_10: 0.00412707170471549
ndcg_20: 0.0056129805743694305
hit_1: 0.001444580633864472
hit_5: 0.004596392925932411
hit_10: 0.008010856242339345
hit_20: 0.013920504289966731
ap: 0.004906777758151293
no increase in recent 0 iters
eval time: 57.71754860877991
#########################################################
################## epoch 2 ###########################
loss: 630.4222, len_train_loader:187, train time: 7.716956377029419
rectified_input_ratio: 0.0
rectified_target_ratio: 0.0
########## current_metrics ##########
ndcg_1: 0.0034582384871301
ndcg_5: 0.006140874233096838
ndcg_10: 0.007865926250815392
ndcg_20: 0.00999726727604866
hit_1: 0.0034582384871301
hit_5: 0.008667483803186833
hit_10: 0.014008054631413063
hit_20: 0.022500437751707233
ap: 0.008266144432127476
########## best_metrics ##########
ndcg_1: 0.0034582384871301
ndcg_5: 0.006140874233096838
ndcg_10: 0.007865926250815392
ndcg_20: 0.00999726727604866
hit_1: 0.0034582384871301
hit_5: 0.008667483803186833
hit_10: 0.014008054631413063
hit_20: 0.022500437751707233
ap: 0.008266144432127476
no increase in recent 0 iters
eval time: 59.253868103027344
#########################################################
################## epoch 3 ###########################
loss: 5554.1497, len_train_loader:187, train time: 12.10725212097168
rectified_input_ratio: 0.2604033052921295
rectified_target_ratio: 0.14365041255950928
########## current_metrics ##########
ndcg_1: 0.028016109262826126
ndcg_5: 0.037423886358737946
ndcg_10: 0.041261106729507446
ndcg_20: 0.04537441208958626
hit_1: 0.028016109262826126
hit_5: 0.04657678164944843
hit_10: 0.05857117842759587
hit_20: 0.07503064261950622
ap: 0.039299774914979935
########## best_metrics ##########
ndcg_1: 0.028016109262826126
ndcg_5: 0.037423886358737946
ndcg_10: 0.041261106729507446
ndcg_20: 0.04537441208958626
hit_1: 0.028016109262826126
hit_5: 0.04657678164944843
hit_10: 0.05857117842759587
hit_20: 0.07503064261950622
ap: 0.039299774914979935
no increase in recent 0 iters
eval time: 62.33817911148071
#########################################################
################## epoch 4 ###########################
loss: 2984.3584, len_train_loader:187, train time: 7.530796527862549
rectified_input_ratio: 0.10083428025245667
rectified_target_ratio: 0.06798571348190308
########## current_metrics ##########
ndcg_1: 0.03642094204167396
ndcg_5: 0.047950975596904755
ndcg_10: 0.05289646238088608
ndcg_20: 0.05813077837228775
hit_1: 0.03642094204167396
hit_5: 0.0589213797933812
hit_10: 0.07424268954648923
hit_20: 0.09512344598143933
ap: 0.050702355802059174
########## best_metrics ##########
ndcg_1: 0.03642094204167396
ndcg_5: 0.047950975596904755
ndcg_10: 0.05289646238088608
ndcg_20: 0.05813077837228775
hit_1: 0.03642094204167396
hit_5: 0.0589213797933812
hit_10: 0.07424268954648923
hit_20: 0.09512344598143933
ap: 0.050702355802059174
no increase in recent 0 iters
eval time: 56.883837938308716
#########################################################
################## epoch 5 ###########################
loss: 2081.0435, len_train_loader:187, train time: 10.470016717910767
rectified_input_ratio: 0.05902213603258133
rectified_target_ratio: 0.042886603623628616
########## current_metrics ##########
ndcg_1: 0.03895990194361758
ndcg_5: 0.05158919095993042
ndcg_10: 0.056875359266996384
ndcg_20: 0.06273732334375381
hit_1: 0.03895990194361758
hit_5: 0.06356154789003678
hit_10: 0.07997723691122395
hit_20: 0.10326562773594818
ap: 0.054764728993177414
########## best_metrics ##########
ndcg_1: 0.03895990194361758
ndcg_5: 0.05158919095993042
ndcg_10: 0.056875359266996384
ndcg_20: 0.06273732334375381
hit_1: 0.03895990194361758
hit_5: 0.06356154789003678
hit_10: 0.07997723691122395
hit_20: 0.10326562773594818
ap: 0.054764728993177414
no increase in recent 0 iters
eval time: 58.24470138549805
#########################################################
################## epoch 6 ###########################
loss: 1577.0819, len_train_loader:187, train time: 9.472614765167236
rectified_input_ratio: 0.04085124284029007
rectified_target_ratio: 0.032597657293081284
########## current_metrics ##########
ndcg_1: 0.040929784626160044
ndcg_5: 0.05496545881032944
ndcg_10: 0.06034606322646141
ndcg_20: 0.06628934293985367
hit_1: 0.040929784626160044
hit_5: 0.0676326387672912
hit_10: 0.0843985291542637
hit_20: 0.10799334617405008
ap: 0.05811266601085663
########## best_metrics ##########
ndcg_1: 0.040929784626160044
ndcg_5: 0.05496545881032944
ndcg_10: 0.06034606322646141
ndcg_20: 0.06628934293985367
hit_1: 0.040929784626160044
hit_5: 0.0676326387672912
hit_10: 0.0843985291542637
hit_20: 0.10799334617405008
ap: 0.05811266601085663
no increase in recent 0 iters
eval time: 61.35475754737854
#########################################################
################## epoch 7 ###########################
loss: 1291.0673, len_train_loader:187, train time: 9.820943117141724
rectified_input_ratio: 0.03193138912320137
rectified_target_ratio: 0.0276167131960392
########## current_metrics ##########
ndcg_1: 0.04189283838206969
ndcg_5: 0.05653311312198639
ndcg_10: 0.06198937073349953
ndcg_20: 0.06818503886461258
hit_1: 0.04189283838206969
hit_5: 0.06990894764489582
hit_10: 0.08689371388548416
hit_20: 0.11145158466118017
ap: 0.05962420254945755
########## best_metrics ##########
ndcg_1: 0.04189283838206969
ndcg_5: 0.05653311312198639
ndcg_10: 0.06198937073349953
ndcg_20: 0.06818503886461258
hit_1: 0.04189283838206969
hit_5: 0.06990894764489582
hit_10: 0.08689371388548416
hit_20: 0.11145158466118017
ap: 0.05962420254945755
no increase in recent 0 iters
eval time: 55.875853061676025
#########################################################
################## epoch 8 ###########################
loss: 1136.6496, len_train_loader:187, train time: 8.52451205253601
rectified_input_ratio: 0.027271578088402748
rectified_target_ratio: 0.02484213560819626
########## current_metrics ##########
ndcg_1: 0.043381194186657326
ndcg_5: 0.05758121609687805
ndcg_10: 0.06300674378871918
ndcg_20: 0.06913981586694717
hit_1: 0.043381194186657326
hit_5: 0.07087200140080546
hit_10: 0.0877254421292243
hit_20: 0.112195762563474
ap: 0.06079525128006935
########## best_metrics ##########
ndcg_1: 0.043381194186657326
ndcg_5: 0.05758121609687805
ndcg_10: 0.06300674378871918
ndcg_20: 0.06913981586694717
hit_1: 0.043381194186657326
hit_5: 0.07087200140080546
hit_10: 0.0877254421292243
hit_20: 0.112195762563474
ap: 0.06079525128006935
no increase in recent 0 iters
eval time: 62.05996870994568
#########################################################
################## epoch 9 ###########################
loss: 1068.4478, len_train_loader:187, train time: 9.627139806747437
rectified_input_ratio: 0.024639790877699852
rectified_target_ratio: 0.022652916610240936
########## current_metrics ##########
ndcg_1: 0.04438802311329014
ndcg_5: 0.058654703199863434
ndcg_10: 0.06412219256162643
ndcg_20: 0.07046353071928024
hit_1: 0.04438802311329014
hit_5: 0.07165995447382245
hit_10: 0.08864472071441079
hit_20: 0.11394676939240063
ap: 0.06202729418873787
########## best_metrics ##########
ndcg_1: 0.04438802311329014
ndcg_5: 0.058654703199863434
ndcg_10: 0.06412219256162643
ndcg_20: 0.07046353071928024
hit_1: 0.04438802311329014
hit_5: 0.07165995447382245
hit_10: 0.08864472071441079
hit_20: 0.11394676939240063
ap: 0.06202729418873787
no increase in recent 0 iters
eval time: 60.94844365119934
#########################################################
################## epoch 10 ###########################
loss: 1029.993, len_train_loader:187, train time: 10.396355628967285
rectified_input_ratio: 0.022549794986844063
rectified_target_ratio: 0.02099769376218319
########## current_metrics ##########
ndcg_1: 0.045613727893538784
ndcg_5: 0.060067836195230484
ndcg_10: 0.06564659625291824
ndcg_20: 0.07155675441026688
hit_1: 0.045613727893538784
hit_5: 0.07349851164419541
hit_10: 0.09087725442129224
hit_20: 0.11438452109963229
ap: 0.06329021602869034
########## best_metrics ##########
ndcg_1: 0.045613727893538784
ndcg_5: 0.060067836195230484
ndcg_10: 0.06564659625291824
ndcg_20: 0.07155675441026688
hit_1: 0.045613727893538784
hit_5: 0.07349851164419541
hit_10: 0.09087725442129224
hit_20: 0.11438452109963229
ap: 0.06329021602869034
no increase in recent 0 iters
eval time: 55.78435778617859
#########################################################
################## epoch 11 ###########################
loss: 1005.6113, len_train_loader:187, train time: 10.172599792480469
rectified_input_ratio: 0.02090868167579174
rectified_target_ratio: 0.01963943801820278
########## current_metrics ##########
ndcg_1: 0.04631413062510944
ndcg_5: 0.06041053682565689
ndcg_10: 0.06619822978973389
ndcg_20: 0.07211672514677048
hit_1: 0.04631413062510944
hit_5: 0.07367361232708808
hit_10: 0.09166520749430923
hit_20: 0.11512869900192611
ap: 0.06382936984300613
########## best_metrics ##########
ndcg_1: 0.04631413062510944
ndcg_5: 0.06041053682565689
ndcg_10: 0.06619822978973389
ndcg_20: 0.07211672514677048
hit_1: 0.04631413062510944
hit_5: 0.07367361232708808
hit_10: 0.09166520749430923
hit_20: 0.11512869900192611
ap: 0.06382936984300613
no increase in recent 0 iters
eval time: 60.80776786804199
#########################################################
################## epoch 12 ###########################
loss: 997.922, len_train_loader:187, train time: 12.828511238098145
rectified_input_ratio: 0.019563285633921623
rectified_target_ratio: 0.018361076712608337
########## current_metrics ##########
ndcg_1: 0.04556995272281562
ndcg_5: 0.060050807893276215
ndcg_10: 0.06613189727067947
ndcg_20: 0.07186635583639145
hit_1: 0.04556995272281562
hit_5: 0.07345473647347224
hit_10: 0.0924531605673262
hit_20: 0.11534757485554194
ap: 0.06349270045757294
########## best_metrics ##########
ndcg_1: 0.04631413062510944
ndcg_5: 0.06041053682565689
ndcg_10: 0.06619822978973389
ndcg_20: 0.07211672514677048
hit_1: 0.04631413062510944
hit_5: 0.07367361232708808
hit_10: 0.0924531605673262
hit_20: 0.11534757485554194
ap: 0.06382936984300613
no increase in recent 0 iters
eval time: 62.03803277015686
#########################################################
################## epoch 13 ###########################
loss: 990.5658, len_train_loader:187, train time: 8.11447525024414
rectified_input_ratio: 0.01830448769032955
rectified_target_ratio: 0.017075074836611748
########## current_metrics ##########
ndcg_1: 0.04535107686919979
ndcg_5: 0.06005632504820824
ndcg_10: 0.06584373116493225
ndcg_20: 0.07229280471801758
hit_1: 0.04535107686919979
hit_5: 0.07384871300998073
hit_10: 0.09179653300647872
hit_20: 0.11749255822097707
ap: 0.06346745043992996
########## best_metrics ##########
ndcg_1: 0.04631413062510944
ndcg_5: 0.06041053682565689
ndcg_10: 0.06619822978973389
ndcg_20: 0.07229280471801758
hit_1: 0.04631413062510944
hit_5: 0.07384871300998073
hit_10: 0.0924531605673262
hit_20: 0.11749255822097707
ap: 0.06382936984300613
no increase in recent 0 iters
eval time: 59.43574357032776
#########################################################
################## epoch 14 ###########################
loss: 984.7131, len_train_loader:187, train time: 9.535398244857788
rectified_input_ratio: 0.017021995037794113
rectified_target_ratio: 0.01598689705133438
########## current_metrics ##########
ndcg_1: 0.04565750306426195
ndcg_5: 0.06070529296994209
ndcg_10: 0.06622335314750671
ndcg_20: 0.07263298332691193
hit_1: 0.04565750306426195
hit_5: 0.07494309227805988
hit_10: 0.09214673437226405
hit_20: 0.11775520924531606
ap: 0.0638631284236908
########## best_metrics ##########
ndcg_1: 0.04631413062510944
ndcg_5: 0.06070529296994209
ndcg_10: 0.06622335314750671
ndcg_20: 0.07263298332691193
hit_1: 0.04631413062510944
hit_5: 0.07494309227805988
hit_10: 0.0924531605673262
hit_20: 0.11775520924531606
ap: 0.0638631284236908
no increase in recent 0 iters
eval time: 59.34235215187073
#########################################################
################## epoch 15 ###########################
loss: 976.5525, len_train_loader:187, train time: 10.62978982925415
rectified_input_ratio: 0.015976451337337494
rectified_target_ratio: 0.015135668218135834
########## current_metrics ##########
ndcg_1: 0.04640168096655577
ndcg_5: 0.06132661923766136
ndcg_10: 0.0668686255812645
ndcg_20: 0.07341524213552475
hit_1: 0.04640168096655577
hit_5: 0.07524951847312204
hit_10: 0.09254071090877254
hit_20: 0.1187182630012257
ap: 0.06456287950277328
########## best_metrics ##########
ndcg_1: 0.04640168096655577
ndcg_5: 0.06132661923766136
ndcg_10: 0.0668686255812645
ndcg_20: 0.07341524213552475
hit_1: 0.04640168096655577
hit_5: 0.07524951847312204
hit_10: 0.09254071090877254
hit_20: 0.1187182630012257
ap: 0.06456287950277328
no increase in recent 0 iters
eval time: 58.45539665222168
#########################################################
################## epoch 16 ###########################
loss: 979.0098, len_train_loader:187, train time: 7.8319268226623535
rectified_input_ratio: 0.015129822306334972
rectified_target_ratio: 0.014225280843675137
########## current_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06676945835351944
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07520574330239888
hit_10: 0.0917089826650324
hit_20: 0.1189809140255647
ap: 0.06478413939476013
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.0668686255812645
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07524951847312204
hit_10: 0.09254071090877254
hit_20: 0.1189809140255647
ap: 0.06478413939476013
no increase in recent 0 iters
eval time: 59.23005509376526
#########################################################
################## epoch 17 ###########################
loss: 980.9754, len_train_loader:187, train time: 9.527727842330933
rectified_input_ratio: 0.014219590462744236
rectified_target_ratio: 0.013389251194894314
########## current_metrics ##########
ndcg_1: 0.04618280511293994
ndcg_5: 0.06117430701851845
ndcg_10: 0.06687663495540619
ndcg_20: 0.07341291010379791
hit_1: 0.04618280511293994
hit_5: 0.07507441779022939
hit_10: 0.0928471371038347
hit_20: 0.11893713885484153
ap: 0.0645296648144722
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06687663495540619
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07524951847312204
hit_10: 0.0928471371038347
hit_20: 0.1189809140255647
ap: 0.06478413939476013
no increase in recent 0 iters
eval time: 60.03543710708618
#########################################################
################## epoch 18 ###########################
loss: 968.8457, len_train_loader:187, train time: 10.950314044952393
rectified_input_ratio: 0.013392523862421513
rectified_target_ratio: 0.012682298198342323
########## current_metrics ##########
ndcg_1: 0.04578882857643145
ndcg_5: 0.06116609647870064
ndcg_10: 0.06681375950574875
ndcg_20: 0.07346788048744202
hit_1: 0.04578882857643145
hit_5: 0.0756872701803537
hit_10: 0.09328488881106636
hit_20: 0.11972509192785852
ap: 0.06434991210699081
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06687663495540619
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.0756872701803537
hit_10: 0.09328488881106636
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 0 iters
eval time: 58.17231488227844
#########################################################
################## epoch 19 ###########################
loss: 962.0647, len_train_loader:187, train time: 7.717634201049805
rectified_input_ratio: 0.0127218933776021
rectified_target_ratio: 0.011969887651503086
########## current_metrics ##########
ndcg_1: 0.04574505340570828
ndcg_5: 0.06121741980314255
ndcg_10: 0.06701648235321045
ndcg_20: 0.07347846776247025
hit_1: 0.04574505340570828
hit_5: 0.07586237086324636
hit_10: 0.09394151637191385
hit_20: 0.11968131675713535
ap: 0.06437123566865921
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06701648235321045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.09394151637191385
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 0 iters
eval time: 63.47706842422485
#########################################################
################## epoch 20 ###########################
loss: 953.7157, len_train_loader:187, train time: 11.409755945205688
rectified_input_ratio: 0.011976434849202633
rectified_target_ratio: 0.011416562832891941
########## current_metrics ##########
ndcg_1: 0.04587637891787778
ndcg_5: 0.061012499034404755
ndcg_10: 0.06709164381027222
ndcg_20: 0.07323797792196274
hit_1: 0.04587637891787778
hit_5: 0.07524951847312204
hit_10: 0.09407284188408335
hit_20: 0.11849938714760988
ap: 0.06441974639892578
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06709164381027222
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.09407284188408335
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 0 iters
eval time: 63.14512825012207
#########################################################
################## epoch 21 ###########################
loss: 957.1439, len_train_loader:187, train time: 8.36446499824524
rectified_input_ratio: 0.01147790439426899
rectified_target_ratio: 0.01090867817401886
########## current_metrics ##########
ndcg_1: 0.04574505340570828
ndcg_5: 0.06101714074611664
ndcg_10: 0.06712594628334045
ndcg_20: 0.07306120544672012
hit_1: 0.04574505340570828
hit_5: 0.07551216949746103
hit_10: 0.094510593591315
hit_20: 0.11819296095254772
ap: 0.06427397578954697
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 0 iters
eval time: 57.811081647872925
#########################################################
################## epoch 22 ###########################
loss: 948.2818, len_train_loader:187, train time: 9.391016244888306
rectified_input_ratio: 0.010963940061628819
rectified_target_ratio: 0.010405158624053001
########## current_metrics ##########
ndcg_1: 0.04486954999124496
ndcg_5: 0.06020110100507736
ndcg_10: 0.06660714000463486
ndcg_20: 0.07270186394453049
hit_1: 0.04486954999124496
hit_5: 0.07446156540010505
hit_10: 0.09424794256697601
hit_20: 0.11867448783050254
ap: 0.0636616200208664
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 1 iters
eval time: 60.11549758911133
#########################################################
################## epoch 23 ###########################
loss: 946.634, len_train_loader:187, train time: 10.742730379104614
rectified_input_ratio: 0.010460654273629189
rectified_target_ratio: 0.009907952509820461
########## current_metrics ##########
ndcg_1: 0.04526352652775346
ndcg_5: 0.06026781350374222
ndcg_10: 0.06644923985004425
ndcg_20: 0.0726286992430687
hit_1: 0.04526352652775346
hit_5: 0.07472421642444406
hit_10: 0.09389774120119068
hit_20: 0.11849938714760988
ap: 0.0636308491230011
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 2 iters
eval time: 59.19141697883606
#########################################################
################## epoch 24 ###########################
loss: 946.9012, len_train_loader:187, train time: 7.5688159465789795
rectified_input_ratio: 0.009965631179511547
rectified_target_ratio: 0.009459071792662144
########## current_metrics ##########
ndcg_1: 0.044475573454736475
ndcg_5: 0.06003900617361069
ndcg_10: 0.06632110476493835
ndcg_20: 0.07247715443372726
hit_1: 0.044475573454736475
hit_5: 0.07463666608299772
hit_10: 0.09420416739625284
hit_20: 0.11876203817194887
ap: 0.06332609802484512
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 3 iters
eval time: 61.5377779006958
#########################################################
################## epoch 25 ###########################
loss: 939.9937, len_train_loader:187, train time: 12.104388236999512
rectified_input_ratio: 0.009500615298748016
rectified_target_ratio: 0.008920945227146149
########## current_metrics ##########
ndcg_1: 0.04443179828401331
ndcg_5: 0.05956816300749779
ndcg_10: 0.0656934380531311
ndcg_20: 0.07231362164020538
hit_1: 0.04443179828401331
hit_5: 0.0741551392050429
hit_10: 0.09319733846962003
hit_20: 0.11954999124496586
ap: 0.0629175454378128
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11972509192785852
ap: 0.06478413939476013
no increase in recent 4 iters
eval time: 58.63980841636658
#########################################################
################## epoch 26 ###########################
loss: 935.5879, len_train_loader:187, train time: 11.525234937667847
rectified_input_ratio: 0.00908065214753151
rectified_target_ratio: 0.008480092510581017
########## current_metrics ##########
ndcg_1: 0.04346874452810366
ndcg_5: 0.05897653475403786
ndcg_10: 0.06527108699083328
ndcg_20: 0.07193271070718765
hit_1: 0.04346874452810366
hit_5: 0.07367361232708808
hit_10: 0.09328488881106636
hit_20: 0.11985641744002802
ap: 0.062329165637493134
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 0 iters
eval time: 55.956520795822144
#########################################################
################## epoch 27 ###########################
loss: 926.7607, len_train_loader:187, train time: 9.455177545547485
rectified_input_ratio: 0.008559517562389374
rectified_target_ratio: 0.008126070722937584
########## current_metrics ##########
ndcg_1: 0.04276834179653301
ndcg_5: 0.05866401642560959
ndcg_10: 0.06474166363477707
ndcg_20: 0.07146851718425751
hit_1: 0.04276834179653301
hit_5: 0.07367361232708808
hit_10: 0.09240938539660305
hit_20: 0.11919978987918053
ap: 0.061905618757009506
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 1 iters
eval time: 60.810866832733154
#########################################################
################## epoch 28 ###########################
loss: 929.5116, len_train_loader:187, train time: 11.22145938873291
rectified_input_ratio: 0.008210716769099236
rectified_target_ratio: 0.007782492786645889
########## current_metrics ##########
ndcg_1: 0.043293643845211
ndcg_5: 0.05859241634607315
ndcg_10: 0.06491950899362564
ndcg_20: 0.07131730765104294
hit_1: 0.043293643845211
hit_5: 0.07314831027841008
hit_10: 0.09262826125021888
hit_20: 0.11814918578182455
ap: 0.06204202026128769
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 2 iters
eval time: 63.64030742645264
#########################################################
################## epoch 29 ###########################
loss: 917.4238, len_train_loader:187, train time: 9.477753400802612
rectified_input_ratio: 0.007890211418271065
rectified_target_ratio: 0.007550764828920364
########## current_metrics ##########
ndcg_1: 0.042549465942917176
ndcg_5: 0.058190956711769104
ndcg_10: 0.06432930380105972
ndcg_20: 0.07089846581220627
hit_1: 0.042549465942917176
hit_5: 0.07306075993696376
hit_10: 0.09210295920154088
hit_20: 0.11832428646471721
ap: 0.0614473894238472
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 3 iters
eval time: 57.838526248931885
#########################################################
################## epoch 30 ###########################
loss: 920.0067, len_train_loader:187, train time: 10.955515146255493
rectified_input_ratio: 0.007634086534380913
rectified_target_ratio: 0.007258083671331406
########## current_metrics ##########
ndcg_1: 0.04246191560147085
ndcg_5: 0.05818191170692444
ndcg_10: 0.06420502811670303
ndcg_20: 0.07065291702747345
hit_1: 0.04246191560147085
hit_5: 0.07306075993696376
hit_10: 0.09184030817720189
hit_20: 0.11753633339170023
ap: 0.06137220561504364
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 4 iters
eval time: 58.537320375442505
#########################################################
################## epoch 31 ###########################
loss: 919.8512, len_train_loader:187, train time: 9.904431104660034
rectified_input_ratio: 0.007340782787650824
rectified_target_ratio: 0.006975225172936916
########## current_metrics ##########
ndcg_1: 0.04224303974785502
ndcg_5: 0.057788096368312836
ndcg_10: 0.06396975368261337
ndcg_20: 0.0706777349114418
hit_1: 0.04224303974785502
hit_5: 0.07214148135177727
hit_10: 0.09135878129924707
hit_20: 0.11806163544037822
ap: 0.06126074120402336
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 5 iters
eval time: 61.21398091316223
#########################################################
################## epoch 32 ###########################
loss: 920.1813, len_train_loader:187, train time: 8.690487384796143
rectified_input_ratio: 0.007095336448401213
rectified_target_ratio: 0.006667112000286579
########## current_metrics ##########
ndcg_1: 0.04241814043074768
ndcg_5: 0.057637035846710205
ndcg_10: 0.06391270458698273
ndcg_20: 0.07035167515277863
hit_1: 0.04241814043074768
hit_5: 0.07179127998599194
hit_10: 0.09127123095780074
hit_20: 0.11683593066012958
ap: 0.06120122969150543
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 6 iters
eval time: 57.84705305099487
#########################################################
################## epoch 33 ###########################
loss: 913.7936, len_train_loader:187, train time: 11.008974552154541
rectified_input_ratio: 0.006825961638242006
rectified_target_ratio: 0.006449959706515074
########## current_metrics ##########
ndcg_1: 0.04141131150411487
ndcg_5: 0.05687759816646576
ndcg_10: 0.0631025955080986
ndcg_20: 0.06976353377103806
hit_1: 0.04141131150411487
hit_5: 0.07122220276659079
hit_10: 0.09061460339695325
hit_20: 0.1170548065137454
ap: 0.0603916198015213
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 7 iters
eval time: 63.11195158958435
#########################################################
################## epoch 34 ###########################
loss: 910.5422, len_train_loader:187, train time: 9.421523094177246
rectified_input_ratio: 0.006580515298992395
rectified_target_ratio: 0.006229533348232508
########## current_metrics ##########
ndcg_1: 0.04154263701628436
ndcg_5: 0.05699549987912178
ndcg_10: 0.06295829266309738
ndcg_20: 0.06978019326925278
hit_1: 0.04154263701628436
hit_5: 0.07148485379092978
hit_10: 0.0900455261775521
hit_20: 0.11714235685519174
ap: 0.060388050973415375
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 8 iters
eval time: 58.96613335609436
#########################################################
################## epoch 35 ###########################
loss: 899.629, len_train_loader:187, train time: 8.628895998001099
rectified_input_ratio: 0.00635595852509141
rectified_target_ratio: 0.006010198500007391
########## current_metrics ##########
ndcg_1: 0.041192435650499036
ndcg_5: 0.05676209181547165
ndcg_10: 0.06295034289360046
ndcg_20: 0.06960617005825043
hit_1: 0.041192435650499036
hit_5: 0.07122220276659079
hit_10: 0.09048327788478375
hit_20: 0.11696725617229907
ap: 0.06020369008183479
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 9 iters
eval time: 60.383994340896606
#########################################################
################## epoch 36 ###########################
loss: 904.0181, len_train_loader:187, train time: 10.763285160064697
rectified_input_ratio: 0.006178167648613453
rectified_target_ratio: 0.005754073150455952
########## current_metrics ##########
ndcg_1: 0.04110488530905271
ndcg_5: 0.056541066616773605
ndcg_10: 0.06287528574466705
ndcg_20: 0.06974659860134125
hit_1: 0.04110488530905271
hit_5: 0.0705655752057433
hit_10: 0.09026440203116792
hit_20: 0.11766765890386972
ap: 0.060176488012075424
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 10 iters
eval time: 62.97522258758545
#########################################################
################## epoch 37 ###########################
loss: 904.1169, len_train_loader:187, train time: 7.569626569747925
rectified_input_ratio: 0.00592968100681901
rectified_target_ratio: 0.005548456683754921
########## current_metrics ##########
ndcg_1: 0.04106111013832954
ndcg_5: 0.05632074922323227
ndcg_10: 0.06274718791246414
ndcg_20: 0.0694597065448761
hit_1: 0.04106111013832954
hit_5: 0.0705655752057433
hit_10: 0.09052705305550691
hit_20: 0.11740500787953073
ap: 0.05988986790180206
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 11 iters
eval time: 62.90524244308472
#########################################################
################## epoch 38 ###########################
loss: 901.8122, len_train_loader:187, train time: 10.796352624893188
rectified_input_ratio: 0.005719699431210756
rectified_target_ratio: 0.005380253307521343
########## current_metrics ##########
ndcg_1: 0.04141131150411487
ndcg_5: 0.05672068893909454
ndcg_10: 0.06295406818389893
ndcg_20: 0.06977095454931259
hit_1: 0.04141131150411487
hit_5: 0.07109087725442129
hit_10: 0.09043950271406058
hit_20: 0.11771143407459289
ap: 0.06018364802002907
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 12 iters
eval time: 60.47607398033142
#########################################################
################## epoch 39 ###########################
loss: 892.3007, len_train_loader:187, train time: 9.182052373886108
rectified_input_ratio: 0.0054896860383450985
rectified_target_ratio: 0.00518679479137063
########## current_metrics ##########
ndcg_1: 0.041192435650499036
ndcg_5: 0.056445226073265076
ndcg_10: 0.0627850890159607
ndcg_20: 0.06950202584266663
hit_1: 0.041192435650499036
hit_5: 0.07047802486429697
hit_10: 0.09008930134827525
hit_20: 0.11683593066012958
ap: 0.06008217856287956
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 13 iters
eval time: 57.95843195915222
#########################################################
################## epoch 40 ###########################
loss: 893.3108, len_train_loader:187, train time: 9.564138412475586
rectified_input_ratio: 0.005361312534660101
rectified_target_ratio: 0.005046885460615158
########## current_metrics ##########
ndcg_1: 0.04101733496760637
ndcg_5: 0.05653274431824684
ndcg_10: 0.06253223121166229
ndcg_20: 0.06923023611307144
hit_1: 0.04101733496760637
hit_5: 0.07113465242514445
hit_10: 0.08973909998248993
hit_20: 0.11635440378217475
ap: 0.059871964156627655
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 14 iters
eval time: 61.16343903541565
#########################################################
################## epoch 41 ###########################
loss: 895.3636, len_train_loader:187, train time: 10.142163038253784
rectified_input_ratio: 0.005220310762524605
rectified_target_ratio: 0.004938309080898762
########## current_metrics ##########
ndcg_1: 0.04062335843109788
ndcg_5: 0.05624022334814072
ndcg_10: 0.06231677159667015
ndcg_20: 0.06905224174261093
hit_1: 0.04062335843109788
hit_5: 0.07109087725442129
hit_10: 0.08995797583610576
hit_20: 0.11679215548940641
ap: 0.05950973555445671
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 15 iters
eval time: 59.275736570358276
#########################################################
################## epoch 42 ###########################
loss: 892.3866, len_train_loader:187, train time: 7.3586061000823975
rectified_input_ratio: 0.005072139669209719
rectified_target_ratio: 0.004836047068238258
########## current_metrics ##########
ndcg_1: 0.04044825774820522
ndcg_5: 0.05584642291069031
ndcg_10: 0.06215142086148262
ndcg_20: 0.06884977966547012
hit_1: 0.04044825774820522
hit_5: 0.0704342496935738
hit_10: 0.09000175100682893
hit_20: 0.11666082997723691
ap: 0.059269312769174576
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 16 iters
eval time: 61.46864938735962
#########################################################
################## epoch 43 ###########################
loss: 886.408, len_train_loader:187, train time: 12.136330842971802
rectified_input_ratio: 0.004948753397911787
rectified_target_ratio: 0.0047033075243234634
########## current_metrics ##########
ndcg_1: 0.04022938189458939
ndcg_5: 0.05542716011404991
ndcg_10: 0.0618821382522583
ndcg_20: 0.06864776462316513
hit_1: 0.04022938189458939
hit_5: 0.06977762213272631
hit_10: 0.08982665032393626
hit_20: 0.11674838031868325
ap: 0.05897841602563858
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 17 iters
eval time: 58.163586139678955
#########################################################
################## epoch 44 ###########################
loss: 889.4895, len_train_loader:187, train time: 11.253373146057129
rectified_input_ratio: 0.0048203798942267895
rectified_target_ratio: 0.004611489828675985
########## current_metrics ##########
ndcg_1: 0.04049203291892838
ndcg_5: 0.055776629596948624
ndcg_10: 0.061896782368421555
ndcg_20: 0.0687626302242279
hit_1: 0.04049203291892838
hit_5: 0.0704342496935738
hit_10: 0.08947644895815093
hit_20: 0.11674838031868325
ap: 0.059119388461112976
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 18 iters
eval time: 62.047614097595215
#########################################################
################## epoch 45 ###########################
loss: 884.4646, len_train_loader:187, train time: 9.460583686828613
rectified_input_ratio: 0.004708529449999332
rectified_target_ratio: 0.004489195067435503
########## current_metrics ##########
ndcg_1: 0.04001050604097356
ndcg_5: 0.05526679381728172
ndcg_10: 0.061642978340387344
ndcg_20: 0.06836508214473724
hit_1: 0.04001050604097356
hit_5: 0.06969007179127999
hit_10: 0.08943267378742777
hit_20: 0.1161793030992821
ap: 0.05877546966075897
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 19 iters
eval time: 61.556525230407715
#########################################################
################## epoch 46 ###########################
loss: 882.6993, len_train_loader:187, train time: 11.990375518798828
rectified_input_ratio: 0.0045958226546645164
rectified_target_ratio: 0.004392154980450869
########## current_metrics ##########
ndcg_1: 0.03966030467518823
ndcg_5: 0.0549188032746315
ndcg_10: 0.06153729557991028
ndcg_20: 0.0680372565984726
hit_1: 0.03966030467518823
hit_5: 0.0692960952547715
hit_10: 0.08987042549465943
hit_20: 0.11574155139205043
ap: 0.05847099795937538
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 20 iters
eval time: 60.04219889640808
#########################################################
################## epoch 47 ###########################
loss: 886.5049, len_train_loader:187, train time: 9.544862747192383
rectified_input_ratio: 0.00451530609279871
rectified_target_ratio: 0.004285526927560568
########## current_metrics ##########
ndcg_1: 0.039572754333741904
ndcg_5: 0.054787639528512955
ndcg_10: 0.06155509129166603
ndcg_20: 0.06794089823961258
hit_1: 0.039572754333741904
hit_5: 0.06903344423043249
hit_10: 0.09013307651899842
hit_20: 0.11561022587988093
ap: 0.05838038772344589
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 21 iters
eval time: 63.29838728904724
#########################################################
################## epoch 48 ###########################
loss: 886.3992, len_train_loader:187, train time: 10.680597305297852
rectified_input_ratio: 0.004403690341860056
rectified_target_ratio: 0.004163466393947601
########## current_metrics ##########
ndcg_1: 0.03926632813867974
ndcg_5: 0.05470240116119385
ndcg_10: 0.06108715757727623
ndcg_20: 0.06781195104122162
hit_1: 0.03926632813867974
hit_5: 0.06942742076694099
hit_10: 0.08925757310453511
hit_20: 0.11604797758711259
ap: 0.05807973071932793
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 22 iters
eval time: 57.800551891326904
#########################################################
################## epoch 49 ###########################
loss: 880.3588, len_train_loader:187, train time: 7.581239223480225
rectified_input_ratio: 0.004319042898714542
rectified_target_ratio: 0.0041153752245008945
########## current_metrics ##########
ndcg_1: 0.03909122745578708
ndcg_5: 0.05450756847858429
ndcg_10: 0.060923196375370026
ndcg_20: 0.06766147911548615
hit_1: 0.03909122745578708
hit_5: 0.06947119593766415
hit_10: 0.08934512344598144
hit_20: 0.11622307827000525
ap: 0.05781750753521919
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 23 iters
eval time: 62.95126438140869
#########################################################
################## epoch 50 ###########################
loss: 876.0237, len_train_loader:187, train time: 9.670182466506958
rectified_input_ratio: 0.004231590311974287
rectified_target_ratio: 0.004038366489112377
########## current_metrics ##########
ndcg_1: 0.038697250919278586
ndcg_5: 0.054290931671857834
ndcg_10: 0.060878366231918335
ndcg_20: 0.06748676300048828
hit_1: 0.038697250919278586
hit_5: 0.06925232008404833
hit_10: 0.08969532481176677
hit_20: 0.11600420241638942
ap: 0.057618916034698486
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 24 iters
eval time: 59.93162274360657
#########################################################
################## epoch 51 ###########################
loss: 874.2902, len_train_loader:187, train time: 9.829054355621338
rectified_input_ratio: 0.004167597275227308
rectified_target_ratio: 0.003957615699619055
########## current_metrics ##########
ndcg_1: 0.038784801260724915
ndcg_5: 0.054236408323049545
ndcg_10: 0.06076483428478241
ndcg_20: 0.06731052696704865
hit_1: 0.038784801260724915
hit_5: 0.069164769742602
hit_10: 0.08943267378742777
hit_20: 0.1153913500262651
ap: 0.05756670609116554
########## best_metrics ##########
ndcg_1: 0.04679565750306426
ndcg_5: 0.06145733594894409
ndcg_10: 0.06712594628334045
ndcg_20: 0.07362858206033707
hit_1: 0.04679565750306426
hit_5: 0.07586237086324636
hit_10: 0.094510593591315
hit_20: 0.11985641744002802
ap: 0.06478413939476013
no increase in recent 25 iters
eval time: 58.47470474243164
#########################################################
